"use strict";(self.webpackChunkfuckgreggs=self.webpackChunkfuckgreggs||[]).push([[264],{8264:(Pt,Z,c)=>{c.r(Z),c.d(Z,{HomeComponentModule:()=>Zt});var h=c(6895),M=c(5002);function H(i,o,e,n,a,s,l){try{var r=i[s](l),d=r.value}catch(p){return void e(p)}r.done?o(d):Promise.resolve(d).then(n,a)}function N(i){return function(){var o=this,e=arguments;return new Promise(function(n,a){var s=i.apply(o,e);function l(d){H(s,n,a,l,r,"next",d)}function r(d){H(s,n,a,l,r,"throw",d)}l(void 0)})}}var t=c(1571),C=c(529),X=c(4766);let ee=(()=>{class i{constructor(e){this.http=e}ping(){let e=class ${static getDefaultHeaders(){return new C.WM}}.getDefaultHeaders(),n=new C.LE;return this.http.get(`${X.N.normalServicesEndpoint}/system/ping`,{params:n,headers:e})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(C.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var g=c(433),P=c(4247),v=c(399),w=c(4325),x=c(4004),O=c(8271),E=c(5108);let D=(()=>{class i{constructor(e){this.http=e,this.placesEndpoint="https://maps.googleapis.com/maps/api/place",this.apiKey="AIzaSyBDWU0h5aK-6Y0e2jfMMui_IrvDAfE21gU",this.apiCalls=0,this.simpleLog=!1}incrementApiCalls(){this.apiCalls++,this.consoleLog(`Google API calls: ${this.apiCalls}`)}setMap(e){this.map=e}populatePlaceDetails(e){return new Promise(n=>{this.getPlaceDetails(this.map,e.place_id).then(a=>{this.consoleLog("Got location details"),a.opening_hours&&(e.opening_hours=a.opening_hours),e.isOpen=a.opening_hours?.isOpen(),e.formattedPhoneNumber=a.formatted_phone_number,e.rating=Math.round(e.rating),this.consoleLog(a),n(e)})})}getPlaceDetails(e,n){return new Promise(a=>{var s={placeId:n,fields:["type","url","formatted_phone_number","opening_hours","utc_offset_minutes","business_status"]};new google.maps.places.PlacesService(e).getDetails(s,(r,d)=>{this.incrementApiCalls(),d==google.maps.places.PlacesServiceStatus.OK&&a(r)})})}findSpecificPlace(e,n){let a={query:e,fields:["name","geometry","place_id"]};new google.maps.places.PlacesService(this.map).findPlaceFromQuery(a,(l,r)=>{this.incrementApiCalls(),n(l,r)})}findSpecificPlaceNearLocation(e,n,a){let s={query:e,locationBias:{radius:500,center:n},fields:["name","geometry","place_id"]};new google.maps.places.PlacesService(this.map).findPlaceFromQuery(s,(r,d)=>{this.incrementApiCalls(),a(r,d)})}findNearbyLocation(e,n,a,s,l){let r={keyword:e,type:n,location:a,radius:s};new google.maps.places.PlacesService(this.map).nearbySearch(r,(p,u)=>{this.incrementApiCalls(),l(p,u)})}consoleLog(e,n){this.simpleLog&&(n?this.consoleLog(e,n):this.consoleLog(e))}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(C.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var f=(()=>{return(i=f||(f={})).GooglePlaceData="PlaceData",i.GooglePlaceDetails="GooglePlaceDetails",i.GooglePlacePhoto="PlacePhoto",i.NearbySearch="NearbySearch",f;var i})();let te=(()=>{class i{constructor(e){this.http=e,this.keyDelimiter="(:##%io87|78oi%##:)",this.defaultDataExpiryDays=5,this.simpleLog=!1,this.verboseLog=!1}storeData(e,n,a){let s=Date.now();this.storeItem({type:e,identifier:n,dataTypeName:typeof a,data:a,storageDate:s})}storeItem(e){let n=this.createKey(e),a={data:e.data,storageDate:e.storageDate??Date.now()},s=JSON.stringify(a);this.consoleLogVerbose("storing item with key",n),this.consoleLogVerbose(a),localStorage.setItem(n,s)}createKey(e){let n="";return n=[e.identifier,e.type].join(this.keyDelimiter),n}fetchData(e,n,a){let l=this.createKey({type:e,identifier:n});this.consoleLogVerbose("retrieving item",l);let r=localStorage.getItem(l);if(null==r)return this.consoleLogVerbose("Nothing to return"),null;let d=JSON.parse(r),p=this.validateData(d);return null==p?(localStorage.removeItem(l),this.consoleLogVerbose("Nothing valid to return"),null):(this.consoleLog("Cached data retrieved",l),p)}validateData(e,n){let a=86400*(n??this.defaultDataExpiryDays),s=e.storageDate/1e3,l=Date.now()/1e3;return s<l-a?(this.consoleLogVerbose(`Cached data has expired by ${l-s-a} seconds`),null):(this.consoleLog(`Cached data Will expire in ${s+a-l} seconds`),e.data)}consoleLog(e,n){this.simpleLog&&(n?console.log(e,n):console.log(e))}consoleLogVerbose(e,n){this.verboseLog&&(n?console.log(e,n):console.log(e))}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(C.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),V=(()=>{class i{constructor(e,n,a){this.http=e,this.googleMapsService=n,this.localStorageService=a,this.placesEndpoint="https://maps.googleapis.com/maps/api/place",this.apiKey="AIzaSyBDWU0h5aK-6Y0e2jfMMui_IrvDAfE21gU",this.findNearbyLocationOriginalCallback=()=>{},this.findNearbyLocationKey="",this.simpleLog=!1}setMap(e){this.map=e,this.googleMapsService.setMap(e)}getCachedPlaceDetails(e){let n=this.localStorageService.fetchData(f.GooglePlaceDetails,e.place_id,2.5);return e.cached=!0,n}populatePlaceDetails(e,n=!1){let a=null;n||(this.consoleLog("Trying to get cached place details..."),a=this.localStorageService.fetchData(f.GooglePlaceDetails,e.place_id,2.5)),a?(this.consoleLog("Got cached item"),e.cached=!0,Object.assign(e,a)):(n||this.consoleLog("Invalid or missing cached data, getting live data"),this.googleMapsService.populatePlaceDetails(e).then(s=>{let l=Object.assign({},s);l.gotDetails=!1,this.localStorageService.storeData(f.GooglePlaceDetails,l.place_id,l)}))}findNearbyLocation(e,n,a,s,l,r=!1){let d=null;this.findNearbyLocationKey=e+n+a.toString()+s,r||(this.consoleLog("Trying to get cached nearby results..."),d=this.localStorageService.fetchData(f.NearbySearch,this.findNearbyLocationKey,1)),d?(this.consoleLog("Got cached item"),l(d,google.maps.places.PlacesServiceStatus.OK)):(r||this.consoleLog("Invalid or missing cached data, getting live data"),this.findNearbyLocationOriginalCallback=l,this.googleMapsService.findNearbyLocation(e,n,a,s,this.findNearbyLocationCallback.bind(this)))}findNearbyLocationCallback(e,n){this.localStorageService.storeData(f.NearbySearch,this.findNearbyLocationKey,e),this.findNearbyLocationOriginalCallback(e,n)}consoleLog(e,n){this.simpleLog&&(n?this.consoleLog(e,n):this.consoleLog(e))}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(C.eN),t.LFG(D),t.LFG(te))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var ne=c(6408),ie=c(8639);function ae(i,o){if(1&i&&(t.TgZ(0,"p",1),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.AsE(" ",e.placeResult.distanceMiles," (",e.placeResult.distanceTime," walk) ")}}function se(i,o){if(1&i&&(t.TgZ(0,"div",6),t._UZ(1,"p-rating",7),t.TgZ(2,"p"),t._uU(3),t.qZA()()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngModel",e.placeResult.rating)("readonly",!0)("cancel",!1),t.xp6(2),t.Oqu(e.placeResult.user_ratings_total)}}function oe(i,o){if(1&i&&(t.TgZ(0,"p",1),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",null==e.placeResult.isOpen?"Possibly closed":e.placeResult.isOpen?"Open":"Closed"," ")}}function le(i,o){if(1&i&&(t.TgZ(0,"p",1),t._UZ(1,"i",8),t._uU(2),t.qZA()),2&i){const e=t.oxw();t.xp6(2),t.hij(" ",e.placeResult.formattedPhoneNumber," ")}}function re(i,o){if(1&i&&(t.TgZ(0,"p",9),t._UZ(1,"p-badge",10),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("value",e.placeResult.types[0])}}function ce(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"p",11)(1,"button",12),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.getDetails())}),t.qZA()()}}function de(i,o){1&i&&(t.TgZ(0,"p"),t._uU(1,"No rating"),t.qZA())}let J=(()=>{class i{constructor(e,n){this.googleMapsService=e,this.googleMapsCachedService=n,this.gotCachedDetails=!1}ngOnInit(){this.loadData()}loadData(){}getDetails(){this.googleMapsCachedService.populatePlaceDetails(this.placeResult,!0),this.placeResult.gotDetails=!0}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(D),t.Y36(V))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-location-info"]],inputs:{placeResult:"placeResult"},decls:10,vars:8,consts:[["class","m-0",4,"ngIf"],[1,"m-0"],["class","flex gap-2 align-items-center",4,"ngIf","ngIfElse"],["class","m-0 pt-1",4,"ngIf"],["class","m-0 pt-3",4,"ngIf"],["noRating",""],[1,"flex","gap-2","align-items-center"],[3,"ngModel","readonly","cancel"],[1,"pi","pi-phone",2,"font-size","1rem"],[1,"m-0","pt-1"],["severity","secondary",3,"value"],[1,"m-0","pt-3"],["pButton","","type","button","label","more details...",1,"p-button-rounded","p-button-outlined","p-button-secondary",3,"click"]],template:function(e,n){if(1&e&&(t.YNc(0,ae,2,2,"p",0),t.TgZ(1,"p",1),t._uU(2),t.qZA(),t.YNc(3,se,4,4,"div",2),t.YNc(4,oe,2,1,"p",0),t.YNc(5,le,3,1,"p",0),t.YNc(6,re,2,1,"p",3),t.YNc(7,ce,2,0,"p",4),t.YNc(8,de,2,0,"ng-template",null,5,t.W1O)),2&e){const a=t.MAs(9);t.Q6J("ngIf",n.placeResult.distanceMiles),t.xp6(2),t.hij(" ",n.placeResult.vicinity," "),t.xp6(1),t.Q6J("ngIf",n.placeResult.rating)("ngIfElse",a),t.xp6(1),t.Q6J("ngIf",n.placeResult.gotDetails),t.xp6(1),t.Q6J("ngIf",n.placeResult.formattedPhoneNumber),t.xp6(1),t.Q6J("ngIf","bakery"!=n.placeResult.types[0]),t.xp6(1),t.Q6J("ngIf",!n.placeResult.gotDetails)}},dependencies:[h.O5,v.Hq,ne.iG,g.JJ,g.On,ie.Ct],styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}.container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:stretch;flex-direction:column}header[_ngcontent-%COMP%]{flex:0 0 50px;display:flex;align-items:center;justify-content:flex-start}content[_ngcontent-%COMP%]{flex:1}footer[_ngcontent-%COMP%]{flex:0 0 50px;display:flex;align-items:center;justify-content:flex-end}"]}),i})();const he=function(){return{"background-color":"#ffffff",color:"#ffffff"}};let pe=(()=>{class i{constructor(e,n){this.dialogConfig=e,this.dialogRef=n}ngOnInit(){this.loadData()}loadData(){this.locationOverview=this.dialogConfig.data,this.markerData=this.locationOverview.marker,this.placeData=this.locationOverview.result,this.placeData.photos?.at(0),console.log(this.locationOverview)}onCloseClicked(){this.dialogRef.close()}openInMaps(e){return window.open(`https://www.google.com/maps/search/?api=1&query=${e.geometry.location?.lat??0},${e.geometry.location?.lng??0}&query_place_id=${e.place_id}`),!1}getDirections(){this.dialogRef.close(this.placeData)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(w.S),t.Y36(w.E7))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-location-overview-dialog"]],decls:16,vars:7,consts:[[1,"container","pt-3","pb-2","px-4"],[1,"gap-2"],["shape","square","size","large",3,"image"],[1,"font-bold","white-space-nowrap","flex-grow-1"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-rounded","p-button-text","p-button-plain",3,"click"],[3,"placeResult"],["icon","pi pi-directions","severity","info","label","Directions",3,"click"],["icon","pi pi-map","severity","info","label","Open in maps",3,"click"],["pButton","","pRipple","","type","button",1,"p-button-rounded","p-button-text","p-button-plain",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"header",1),t._UZ(2,"p-avatar",2),t.TgZ(3,"span",3),t._uU(4),t._UZ(5,"br"),t._uU(6),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){return n.onCloseClicked()}),t.qZA()(),t.TgZ(8,"content"),t._UZ(9,"app-location-info",5),t.qZA(),t._UZ(10,"p-divider"),t.TgZ(11,"footer",1)(12,"p-button",6),t.NdJ("click",function(){return n.getDirections()}),t.qZA(),t.TgZ(13,"p-button",7),t.NdJ("click",function(){return n.openInMaps(n.placeData)}),t.qZA(),t.TgZ(14,"button",8),t.NdJ("click",function(){return n.onCloseClicked()}),t._uU(15," Ok"),t.qZA()()()),2&e&&(t.xp6(2),t.Akn(t.DdM(6,he)),t.Q6J("image",n.placeData.icon),t.xp6(2),t.hij(" ",n.placeData.name,""),t.xp6(2),t.hij("",n.placeData.milesFromMe,"m (direct)"),t.xp6(3),t.Q6J("placeResult",n.placeData))},dependencies:[v.Hq,v.zx,O.q,E.i,J],styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}.container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:stretch;flex-direction:column}header[_ngcontent-%COMP%]{flex:0 0 50px;display:flex;align-items:center;padding-bottom:1rem;justify-content:flex-start}content[_ngcontent-%COMP%]{flex:1}footer[_ngcontent-%COMP%]{flex:0 0 50px;display:flex;align-items:center;justify-content:flex-end}"]}),i})();var I=c(7705),ue=c(805),ge=c(1740),G=c(2174),F=c(5054);function me(i,o){if(1&i&&t._UZ(0,"p-image",8),2&i){const e=t.oxw();let n;t.Q6J("src",null!==(n=e.photoUrl)&&void 0!==n?n:e.placeResult.icon)("preview",!0)}}const fe=function(){return{"background-color":"#ffffff",color:"#ffffff"}};let ve=(()=>{class i{constructor(){this.onGetDirections=new t.vpe,this.getPhotos=!1}ngOnInit(){this.loadData()}loadData(){if(this.getPhotos){let e=this.placeResult.photos?.at(0)??null;this.photoUrl=e?.getUrl()??""}}openInMaps(e){return window.open(`https://www.google.com/maps/search/?api=1&query=${e.geometry.location?.lat??0},${e.geometry.location?.lng??0}&query_place_id=${e.place_id}`),!1}getDirections(){this.onGetDirections.emit(this.placeResult)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-location-overview"]],inputs:{placeResult:"placeResult"},outputs:{onGetDirections:"onGetDirections"},decls:15,vars:8,consts:[[1,"container","pt-3","pb-2","px-4"],[1,"gap-2"],["shape","circle","size","large",3,"image"],[3,"src","preview",4,"ngIf"],[1,"font-bold","white-space-nowrap","flex-grow-1"],[3,"placeResult"],["icon","pi pi-directions","severity","info","label","Directions",3,"click"],["icon","pi pi-map","severity","info","label","Open in maps",3,"click"],[3,"src","preview"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"header",1)(2,"p-avatar",2)(3,"span"),t.YNc(4,me,1,2,"p-image",3),t.qZA()(),t.TgZ(5,"span",4),t._uU(6),t._UZ(7,"br"),t._uU(8),t.qZA()(),t.TgZ(9,"content"),t._UZ(10,"app-location-info",5),t.qZA(),t._UZ(11,"p-divider"),t.TgZ(12,"footer",1)(13,"p-button",6),t.NdJ("click",function(){return n.getDirections()}),t.qZA(),t.TgZ(14,"p-button",7),t.NdJ("click",function(){return n.openInMaps(n.placeResult)}),t.qZA()()()),2&e&&(t.xp6(2),t.Akn(t.DdM(7,fe)),t.Q6J("image",n.photoUrl?"":n.placeResult.icon),t.xp6(2),t.Q6J("ngIf",""!=n.photoUrl),t.xp6(2),t.hij(" ",n.placeResult.name,""),t.xp6(2),t.hij("",n.placeResult.milesFromMe,"m (direct) "),t.xp6(2),t.Q6J("placeResult",n.placeResult))},dependencies:[h.O5,v.zx,O.q,E.i,F.E,J],styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}.container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:stretch;flex-direction:column}header[_ngcontent-%COMP%]{flex:0 0 50px;display:flex;align-items:center;justify-content:flex-start;padding-bottom:1rem}content[_ngcontent-%COMP%]{flex:1}footer[_ngcontent-%COMP%]{flex:0 0 50px;display:flex;align-items:center;justify-content:flex-end}"]}),i})();function _e(i,o){if(1&i&&t._UZ(0,"map-directions-renderer",14),2&i){const e=t.oxw();t.Q6J("directions",e.directionsResults)}}function ye(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",4)(1,"input",15),t.NdJ("ngModelChange",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.inputKeyword=a)})("keyup.enter",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.searchedThisLocation?null:a.fuckGreggs())})("change",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.searchedThisLocation=!1)}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngModel",e.inputKeyword)}}function Ce(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"p-button",16),t.NdJ("onClick",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.fuckGreggs())}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("disabled",!e.mapReady||e.searchedThisLocation||e.loading)}}function xe(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"p-button",17),t.NdJ("onClick",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.zoomAllResults())}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("disabled",!e.mapReady||e.validResults.length<=0)}}function be(i,o){1&i&&(t.TgZ(0,"span")(1,"p"),t._uU(2,"Searching..."),t.qZA()())}function Me(i,o){if(1&i&&t._uU(0),2&i){const e=t.oxw().$implicit;t.AsE(" ",e.milesFromMe,"m - ",e.name," ")}}function Se(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"p-accordionTab"),t.YNc(1,Me,1,2,"ng-template",20),t.TgZ(2,"app-location-overview",21),t.NdJ("onGetDirections",function(a){t.CHM(e);const s=t.oxw(2);return t.KtG(s.getDirectionsToResult(a))}),t.qZA()()}if(2&i){const e=o.$implicit;t.xp6(2),t.Q6J("placeResult",e)}}function we(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"span")(1,"p-accordion",18),t.NdJ("activeIndexChange",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.activeLocationTab=a)}),t.YNc(2,Se,3,1,"p-accordionTab",19),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("activeIndex",e.activeLocationTab),t.xp6(1),t.Q6J("ngForOf",e.validResults)}}function Te(i,o){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.AsE(" ",e.directionDistanceMiles," (",e.directionDistanceTime," walk) ")}}function Le(i,o){1&i&&(t.TgZ(0,"p"),t._uU(1,"No locations found"),t.qZA())}function De(i,o){if(1&i&&t.YNc(0,Le,2,0,"p",10),2&i){const e=t.oxw();t.Q6J("ngIf",e.searchedThisLocation&&!e.loading)}}const Ie=function(i){return{"max-h-30rem":!0,"w-full":!0,"h-30rem":i}};let Ae=(()=>{class i{constructor(e,n,a,s){this.dialogService=e,this.googleMapsCachedService=n,this.googleMapsService=a,this.mapDirectionsService=s,this.mapReady=!1,this.searchedThisLocation=!1,this.center=new google.maps.LatLng(-37.11127917893532,-12.287298806127833),this.zoom=10,this.allowKeywordEntry=!1,this.loading=!1,this.removePoiLabelsStyle={featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},this.mapOptions={clickableIcons:!1,styles:[this.removePoiLabelsStyle],fullscreenControl:!1,keyboardShortcuts:!1},this.markers=[],this.results=[],this.validResults=[],this.activeLocationTab=0,this.directionDistanceMiles="",this.directionDistanceTime="",this.simpleLog=!1}ngOnInit(){}onMapReady(e){this.googleMapsService.map=e,this.mapReady=!0,this.map=e,this.createSearchBox()}createSearchBox(){}userSearchedPlace(e){this.googleMapsService.findSpecificPlace(e.currentTarget.value,(a,s)=>{if(s===google.maps.places.PlacesServiceStatus.OK&&a.length>0){let l=a[0],r=new google.maps.LatLng(l.geometry?.location?.lat()??0,l.geometry?.location?.lng()??0),d=3;const p=1609;(null==this.currentLocation?999:this.getCrowFlyMiles(this.currentLocation,r)*p)>d&&(this.clearResults(),this.createHomeMarker(r),this.center=r,this.fitBoundsToMarkers([l]))}})}fitBoundsToMarkers(e){const n=new google.maps.LatLngBounds;e.forEach(a=>{a.geometry?.viewport?n.union(a.geometry.viewport):n.extend(a.geometry?.location??{lat:0,lng:0})}),this.map.fitBounds(n)}createDirectionInfo(){const e=document.getElementById("direction-info");-1==this.map.controls[google.maps.ControlPosition.BOTTOM_CENTER].indexOf(e)&&this.map.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(e)}getDirections(e,n){const a={destination:n,origin:e,travelMode:google.maps.TravelMode.WALKING};return this.googleMapsService.incrementApiCalls(),this.mapDirectionsService.route(a).pipe((0,x.U)(s=>s.result))}getDirectionsToResult(e){this.getDirections(this.currentLocation,e.geometry.location).subscribe(n=>{if(n){let a=n.routes[0].legs[0];e.distanceMiles=((a.distance?.value??0)/1609).toFixed(1)+"m",e.distanceTime=a.duration?.text,this.openAccordionToResult(e),this.directionsResults=n,this.directionDistanceMiles=e.distanceMiles,this.directionDistanceTime=e.distanceTime??"",this.createDirectionInfo()}})}openAccordionToResult(e){this.activeLocationTab=this.validResults.indexOf(e)}fuckGreggs(){this.consoleLog("Fucking greggs"),this.clearResults(),this.searchedThisLocation=!0,this.loading=!0,this.googleMapsCachedService.findNearbyLocation(this.inputKeyword,"bakery",this.currentLocation,2500,this.getPlacesResults.bind(this))}clearResults(){this.results=[],this.validResults=[],this.directionsResults=void 0,this.markers.forEach(e=>{e.setVisible(!1)}),this.markers=[]}getPlacesResults(e,n){if(e=e??[],this.loading=!1,this.consoleLog(e),e=this.filterResults(e),this.consoleLog("Filtered results",e),n===google.maps.places.PlacesServiceStatus.OK&&e.length>0){for(var a=0;a<e.length;a++){let s=e[a],l=!1,r=s.geometry.location??new google.maps.LatLng(0,0),d=this.googleMapsCachedService.getCachedPlaceDetails(s);null!=d&&Object.assign(s,d),s.milesFromMe=this.getCrowFlyMiles(this.currentLocation,r),this.createMarker(s,l)}if(e.sort((s,l)=>(s.milesFromMe??9999)>(l.milesFromMe??9999)?1:-1),this.validResults.length>0){let s=this.validResults[0].geometry.location??new google.maps.LatLng(0,0);this.center=s,this.getDirectionsToResult(this.validResults[0])}}}filterResults(e){let n=["supermarket","grocery_or_supermarket"],a=[];return e.forEach(s=>{let l=!0;null!=s.types&&s.types.length>0&&s.types.some(d=>n.includes(d))&&(l=!1),l&&a.push(s)}),a}createMarker(e,n=!1){let l=e.name.toLowerCase().includes("greggs"),d={url:l?"assets/icons/middleFinger48.png":"assets/icons/location128.png",scaledSize:new google.maps.Size(48,48),labelOrigin:new google.maps.Point(24,48*1.15)};var u=new google.maps.Marker({map:this.map,position:e.geometry.location,title:e.name,icon:d,label:{text:l?" ":`${e.name}`,color:"black",fontFamily:"Arial",fontSize:"20px",fontWeight:"bold"},animation:google.maps.Animation.DROP,clickable:!0,cursor:l?"not-allowed":""});l||(u.addListener("click",y=>{this.markerClicked(u,e)}),u.addListener("mouseover",y=>{this.markerEntered(u,e)}),u.addListener("mouseout",y=>{this.markerExited(u,e)})),this.markers.push(u),l||(this.results.push(e),this.results.sort((y,R)=>(y.milesFromMe??9999)>(R.milesFromMe??9999)?1:-1),this.validResults=this.getValidResultsInResults(this.results))}markerClicked(e,n){this.consoleLog(`CLICKED ${n.name}`),this.openLocationOverviewDialog(e,n)}markerEntered(e,n){this.setIconSize(e,64)}markerExited(e,n){this.setIconSize(e,48)}setIconSize(e,n){let a=e.getIcon();a.scaledSize=new google.maps.Size(n,n),a.size=new google.maps.Size(n,n),a.labelOrigin=new google.maps.Point(n/2,1.15*n),e.setIcon(a)}openLocationOverviewDialog(e,n){this.dynamicDialogRef=this.dialogService.open(pe,{header:"",showHeader:!1,width:"50%",contentStyle:{overflow:"auto",padding:"0"},styleClass:"prime-dialog",baseZIndex:1e4,maximizable:!1,data:{marker:e,result:n}}),this.dynamicDialogRef.onClose.subscribe(a=>{a&&this.getDirectionsToResult(a)})}getCurrentLocation(){return new Promise(n=>{this.consoleLog("Requestion permission..."),navigator.geolocation&&navigator.geolocation.getCurrentPosition(a=>{if(a){if(null!=this.currentLocation&&this.currentLocation.lat()==a.coords.latitude&&this.currentLocation.lng()==a.coords.longitude)return n(!0);this.consoleLog("Got position",a),this.clearResults();let s=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);return this.center=s,this.currentLocation=s,this.zoom=16,this.createHomeMarker(s),n(!0)}return this.consoleLog("Error getting position, no geolocation"),n(!1)},a=>(this.consoleLog("Unable to get position",a),n(!1)))})}createHomeMarker(e){if(this.currentLocation=e,this.searchedThisLocation=!1,this.currentLocationMarker)return void this.currentLocationMarker.setPosition(e);let s={url:"assets/icons/person128.png",scaledSize:new google.maps.Size(48,48),labelOrigin:new google.maps.Point(24,48*1.15)};var r=new google.maps.Marker({map:this.map,position:e,title:"You",icon:s,label:{text:"You",color:"black",fontFamily:"Arial",fontSize:"15px",fontWeight:"bold"},animation:google.maps.Animation.DROP,clickable:!0,cursor:"default"});this.currentLocationMarker=r}getCrowFlyMiles(e,n){let a="number"==(typeof e.lat).toLowerCase()?e.lat:e.lat(),s="number"==(typeof e.lng).toLowerCase()?e.lng:e.lng(),l="number"==(typeof n.lat).toLowerCase()?n.lat:n.lat(),r="number"==(typeof n.lng).toLowerCase()?n.lng:n.lng();var p=this.deg2rad(l-a),u=this.deg2rad(r-s),y=Math.sin(p/2)*Math.sin(p/2)+Math.cos(this.deg2rad(a))*Math.cos(this.deg2rad(l))*Math.sin(u/2)*Math.sin(u/2);return+(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y))*6371/1.609).toFixed(2)}deg2rad(e){return e*(Math.PI/180)}zoomAllResults(){this.fitBoundsToMarkers(this.validResults)}consoleLog(e,n){this.simpleLog&&(n?this.consoleLog(e,n):this.consoleLog(e))}getValidResultsInResults(e){let n=[];return e.forEach(a=>{a.name.toLowerCase().includes("greggs")||n.push(a)}),n}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(w.xA),t.Y36(V),t.Y36(D),t.Y36(I.Tx))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-normal-map"]],features:[t._Bn([w.xA])],decls:19,vars:21,consts:[[3,"ngClass"],["mapContainer",""],[3,"width","height","center","zoom","options","mapInitialized"],[3,"directions",4,"ngIf"],[1,"flex","gap-2"],["id","pac-input","type","text","placeholder","Search location","pInputText","",1,"controls","w-25rem",3,"change"],["class","flex gap-2",4,"ngIf"],["label","Get location via GPS",1,"my-2",3,"disabled","onClick"],["class","my-2","label","Fuck Greggs",3,"disabled","onClick",4,"ngIf"],["class","my-2","label","View all",3,"disabled","onClick",4,"ngIf"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["id","direction-info",1,"text-primary","text-lg","font-bold","bg-black-alpha-70","p-2"],["noLocations",""],[3,"directions"],["id","keyword-input","type","text","placeholder","Keyword","pInputText","",1,"controls","w-25rem",3,"ngModel","ngModelChange","keyup.enter","change"],["label","Fuck Greggs",1,"my-2",3,"disabled","onClick"],["label","View all",1,"my-2",3,"disabled","onClick"],[3,"activeIndex","activeIndexChange"],[4,"ngFor","ngForOf"],["pTemplate","header"],[3,"placeResult","onGetDirections"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div")(1,"div",0,1)(3,"google-map",2),t.NdJ("mapInitialized",function(s){return n.onMapReady(s)}),t.YNc(4,_e,1,1,"map-directions-renderer",3),t.qZA()(),t._UZ(5,"br"),t.TgZ(6,"div",4)(7,"input",5),t.NdJ("change",function(s){return n.userSearchedPlace(s)}),t.qZA()(),t.YNc(8,ye,2,1,"div",6),t.TgZ(9,"div",4)(10,"p-button",7),t.NdJ("onClick",function(){return n.getCurrentLocation()}),t.qZA(),t.YNc(11,Ce,1,1,"p-button",8),t.YNc(12,xe,1,1,"p-button",9),t.qZA(),t.YNc(13,be,3,0,"span",10),t.YNc(14,we,3,2,"span",11),t.qZA(),t.TgZ(15,"div",12),t.YNc(16,Te,2,2,"div",10),t.qZA(),t.YNc(17,De,1,1,"ng-template",null,13,t.W1O)),2&e){const a=t.MAs(2),s=t.MAs(18);t.xp6(1),t.Q6J("ngClass",t.VKq(19,Ie,n.currentLocation)),t.xp6(2),t.Tol(n.currentLocation?"":"hidden"),t.Q6J("width",a.offsetWidth+"px")("height",a.offsetHeight+"px")("center",n.center)("zoom",n.zoom)("options",n.mapOptions),t.xp6(1),t.Q6J("ngIf",n.directionsResults),t.xp6(4),t.Q6J("ngIf",n.allowKeywordEntry),t.xp6(2),t.Q6J("disabled",!n.mapReady),t.xp6(1),t.Q6J("ngIf",n.currentLocation),t.xp6(1),t.Q6J("ngIf",n.currentLocation&&n.validResults.length>0),t.xp6(1),t.Q6J("ngIf",n.loading),t.xp6(1),t.Q6J("ngIf",n.validResults.length>0)("ngIfElse",s),t.xp6(1),t.Udp("display",n.directionDistanceMiles?"block":"none"),t.xp6(1),t.Q6J("ngIf",n.directionDistanceMiles)}},dependencies:[h.mk,h.sg,h.O5,ue.jx,v.zx,I.b6,I.jG,ge.o,G.UQ,G.US,g.Fj,g.JJ,g.On,ve]}),i})();var ke=c(8421),U=c(9751),Re=c(5577),Ze=c(1144),_=c(576),He=c(3268);const Ne=["addListener","removeListener"],Pe=["addEventListener","removeEventListener"],Oe=["on","off"];function m(i,o,e,n){if((0,_.m)(e)&&(n=e,e=void 0),n)return m(i,o,e).pipe((0,He.Z)(n));const[a,s]=function Je(i){return(0,_.m)(i.addEventListener)&&(0,_.m)(i.removeEventListener)}(i)?Pe.map(l=>r=>i[l](o,r,e)):function Ee(i){return(0,_.m)(i.addListener)&&(0,_.m)(i.removeListener)}(i)?Ne.map(Y(i,o)):function Ve(i){return(0,_.m)(i.on)&&(0,_.m)(i.off)}(i)?Oe.map(Y(i,o)):[];if(!a&&(0,Ze.z)(i))return(0,Re.z)(l=>m(l,o,e))((0,ke.Xf)(i));if(!a)throw new TypeError("Invalid event target");return new U.y(l=>{const r=(...d)=>l.next(1<d.length?d:d[0]);return a(r),()=>s(r)})}function Y(i,o){return e=>n=>i[e](o,n)}var Q=c(727);class Ge extends Q.w0{constructor(o,e){super()}schedule(o,e=0){return this}}const T={setInterval(i,o,...e){const{delegate:n}=T;return n?.setInterval?n.setInterval(i,o,...e):setInterval(i,o,...e)},clearInterval(i){const{delegate:o}=T;return(o?.clearInterval||clearInterval)(i)},delegate:void 0};var Fe=c(8737);const z={now:()=>(z.delegate||Date).now(),delegate:void 0};class S{constructor(o,e=S.now){this.schedulerActionCtor=o,this.now=e}schedule(o,e=0,n){return new this.schedulerActionCtor(this,o).schedule(n,e)}}S.now=z.now;const K=new class Ye extends S{constructor(o,e=S.now){super(o,e),this.actions=[],this._active=!1}flush(o){const{actions:e}=this;if(this._active)return void e.push(o);let n;this._active=!0;do{if(n=o.execute(o.state,o.delay))break}while(o=e.shift());if(this._active=!1,n){for(;o=e.shift();)o.unsubscribe();throw n}}}(class Ue extends Ge{constructor(o,e){super(o,e),this.scheduler=o,this.work=e,this.pending=!1}schedule(o,e=0){var n;if(this.closed)return this;this.state=o;const a=this.id,s=this.scheduler;return null!=a&&(this.id=this.recycleAsyncId(s,a,e)),this.pending=!0,this.delay=e,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(s,this.id,e),this}requestAsyncId(o,e,n=0){return T.setInterval(o.flush.bind(o,this),n)}recycleAsyncId(o,e,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return e;null!=e&&T.clearInterval(e)}execute(o,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(o,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(o,e){let a,n=!1;try{this.work(o)}catch(s){n=!0,a=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),a}unsubscribe(){if(!this.closed){const{id:o,scheduler:e}=this,{actions:n}=e;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Fe.P)(n,this),null!=o&&(this.id=this.recycleAsyncId(e,o,null)),this.delay=null,super.unsubscribe()}}}),Qe=K;var ze=c(3532);var A=c(6451),qe=c(9300),L=c(8505),We=c(3900),Xe=c(590),$e=c(2722);let tt=(()=>{class i{constructor(e,n){this.ngZone=e,this.elementRef=n,this._angle=0,this.circleRadius=0,this.handleDiameter=0,this.angleChange=new t.vpe,this.element=this.elementRef.nativeElement}get angle(){return this._angle}set angle(e){this._angle=e||0,this.setTransform(this.calcHandlePosition(this._angle)),this.angleChange.emit(this._angle)}ngOnInit(){this.positionHandle(),this.registerStart(this.element)}ngOnChanges(e){}positionHandle(){this.handleDiameter=0!=this.handleDiameter?this.handleDiameter:(this.diameter??0)/4,this.circleRadius=(this.diameter??0)/2,this.element.style.width=`${this.handleDiameter}px`,this.element.style.height=`${this.handleDiameter}px`,this.element.style.top=this.circleRadius-this.handleDiameter/2+"px",this.element.style.left=this.circleRadius-this.handleDiameter/2+"px",this.setTransform(this.calcHandlePosition(this.angle))}registerStart(e){this.unregisterStart(),this.ngZone.runOutsideAngular(()=>{const n=m(e,"mousedown").pipe((0,qe.h)(s=>0===s.button),(0,L.b)(s=>{s.target&&s.target.draggable&&s.preventDefault(),s.stopPropagation()}),(0,x.U)(s=>B(s))),a=m(e,"touchstart").pipe((0,We.w)(s=>function je(i=0,o=K){return i<0&&(i=0),function Be(i=0,o,e=Qe){let n=-1;return null!=o&&((0,ze.K)(o)?e=o:n=o),new U.y(a=>{let s=function Ke(i){return i instanceof Date&&!isNaN(i)}(i)?+i-e.now():i;s<0&&(s=0);let l=0;return e.schedule(function(){a.closed||(a.next(l++),0<=n?this.schedule(void 0,n):a.complete())},s)})}(i,i,o)}(500).pipe((0,Xe.P)(),(0,$e.R)(m(document,"touchend")),(0,x.U)(()=>s))),(0,L.b)(s=>{s.stopPropagation()}),(0,x.U)(s=>j(s)));this.elementStartSubscription=(0,A.T)(n,a).subscribe(s=>{this.dragStart(s)})})}unregisterStart(){this.elementStartSubscription&&(this.elementStartSubscription.unsubscribe(),this.elementStartSubscription=void 0)}registerMove(){this.unregisterMove(),this.elementMoveSubscription=new Q.w0;const e=m(document,"mousemove").pipe((0,L.b)(l=>{l.preventDefault()}),(0,x.U)(l=>B(l))),n=m(document,"touchmove").pipe((0,L.b)(l=>{l.preventDefault()}),(0,x.U)(l=>j(l)));this.elementMoveSubscription.add((0,A.T)(e,n).subscribe(l=>{this.dragMove(l)}));const a=m(document,"mouseup"),s=m(document,"touchend");this.elementMoveSubscription.add((0,A.T)(a,s).subscribe(()=>{this.dragStop()}))}unregisterMove(){this.elementMoveSubscription&&(this.elementMoveSubscription.unsubscribe(),this.elementMoveSubscription=void 0)}dragStart(e){this.windowStart=e,this.registerMove()}dragMove(e){const n=this.calcAngle(e);this.layerLatestDelta=this.calcHandlePosition(n),this.setTransform(this.layerLatestDelta),this.ngZone.run(()=>{this.angle=Math.round(n)})}calcAngle(e){let n=0;if(this.diameter){const r={x:e.x-(this.originX??0),y:e.y-(this.originY??0)};n=-Math.atan2(r.x-this.circleRadius,r.y-this.circleRadius)/(Math.PI/180)+180}return n}calcHandlePosition(e){let n=this.circleRadius*Math.sin(e*Math.PI/180),a=this.circleRadius*-Math.cos(e*Math.PI/180),s=this.handleDiameter/5;return n-=s,a-=s,{x:n,y:a}}dragStop(){this.unregisterMove(),this.layerLatestDelta&&this.ngZone.run(()=>{this.layerLatestDelta=void 0})}setTransform(e){this.element.style.transform=`translate(${e.x}px, ${e.y}px)`}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.R0b),t.Y36(t.SBq))},i.\u0275dir=t.lG2({type:i,selectors:[["","circularSliderHandle",""]],inputs:{diameter:"diameter",handleDiameter:"handleDiameter",originX:"originX",originY:"originY",angle:"angle"},outputs:{angleChange:"angleChange"},features:[t.TTD]}),i})();function B(i){return{x:i.pageX,y:i.pageY}}function j(i){const o=i.touches[0];return{x:o.pageX,y:o.pageY}}function nt(i,o){if(1&i&&(t.TgZ(0,"div",3),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij("",e.angle," ")}}const it=function(i,o){return{circle:i,"circle-hidden":o}},at=function(i,o){return{"width.px":i,"height.px":o}},st=function(i,o){return{"circle-handle":i,"circle-handle-hidden":o}};let ot=(()=>{class i{constructor(){this.diameter=0,this.handleDiameter=0,this.originX=0,this.originY=0,this._angle=0,this.angleChange=new t.vpe,this.displayAngle=!0,this.displayCircle=!0,this.displayHandle=!0}get angle(){return this._angle}set angle(e){this._angle=e||0,this.angleChange.emit(this._angle)}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["circular-slider"]],inputs:{diameter:"diameter",handleDiameter:"handleDiameter",originX:"originX",originY:"originY",angle:"angle",displayAngle:"displayAngle",displayCircle:"displayCircle",displayHandle:"displayHandle"},outputs:{angleChange:"angleChange"},decls:3,vars:18,consts:[[3,"ngClass","ngStyle"],["class","rotation",4,"ngIf"],["circularSliderHandle","",1,"",3,"ngClass","originX","originY","diameter","handleDiameter","angle","angleChange"],[1,"rotation"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,nt,2,1,"div",1),t.TgZ(2,"div",2),t.NdJ("angleChange",function(s){return n.angle=s}),t.qZA()()),2&e&&(t.Q6J("ngClass",t.WLB(9,it,n.displayCircle,!n.displayCircle))("ngStyle",t.WLB(12,at,n.diameter,n.diameter)),t.xp6(1),t.Q6J("ngIf",n.displayAngle),t.xp6(1),t.Q6J("ngClass",t.WLB(15,st,n.displayHandle,!n.displayHandle))("originX",n.originX)("originY",n.originY)("diameter",n.diameter)("handleDiameter",n.handleDiameter)("angle",n.angle))},dependencies:[h.mk,h.O5,h.PC,tt],styles:[".circle[_ngcontent-%COMP%]{border:5px solid #e1e1e1;border-radius:100%;position:relative}.circle-hidden[_ngcontent-%COMP%]{border:0px solid #e1e1e1;border-radius:100%;position:relative}.circle-handle[_ngcontent-%COMP%]{position:absolute;touch-action:none;border-radius:100%;background-color:#686868a2;cursor:-webkit-grab;transition:box-shadow .2s cubic-bezier(0,0,.2,1);box-shadow:0 3px 1px -2px #0003,0 2px 2px #00000024,0 1px 5px #0000001f}.circle-handle-hidden[_ngcontent-%COMP%]{position:absolute;touch-action:none;border-radius:100%;background-color:#f000;cursor:-webkit-grab;transition:box-shadow .2s cubic-bezier(0,0,.2,1);box-shadow:0 3px 1px -2px #0003,0 2px 2px #00000024,0 1px 5px #0000001f}.circle-handle[_ngcontent-%COMP%]:active{box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.rotation[_ngcontent-%COMP%]{position:absolute;inset:0;height:100%;width:100%;display:flex;justify-content:center;align-items:center}"]}),i})(),lt=(()=>{class i{constructor(){this.diameter=100,this.handleDiameter=0,this.displayAngle=!0,this.displayCircle=!0,this.displayHandle=!0,this._angle=0,this.angleChange=new t.vpe}get angle(){return this._angle}set angle(e){this._angle=e||0,this.angleChange.emit(this._angle)}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["circular-slider-wrapper"]],inputs:{diameter:"diameter",handleDiameter:"handleDiameter",displayAngle:"displayAngle",displayCircle:"displayCircle",displayHandle:"displayHandle",angle:"angle"},outputs:{angleChange:"angleChange"},decls:3,vars:12,consts:[["container",""],[1,"w-full","h-full",3,"diameter","handleDiameter","originX","originY","displayCircle","displayHandle","displayAngle","angle","angleChange"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",null,0)(2,"circular-slider",1),t.NdJ("angleChange",function(s){return n.angle=s}),t.qZA()()),2&e){const a=t.MAs(1);t.Udp("width",n.diameter,"px")("height",n.diameter,"px"),t.xp6(2),t.Q6J("diameter",n.diameter)("handleDiameter",n.handleDiameter)("originX",a.offsetLeft)("originY",a.offsetTop)("displayCircle",n.displayCircle)("displayHandle",n.displayHandle)("displayAngle",n.displayAngle)("angle",n.angle)}},dependencies:[ot]}),i})();const rt=["compassImage"],ct=function(i){return{transform:i}};let dt=(()=>{class i{constructor(e){this.renderer=e,this._angle=45,this.angleChange=new t.vpe,this.animateAngle=0,this.adjustedAngle=0,this.sliderDiameter=300,this.handleDiameter=4e3,this.circleIncrement=0,this.currentAngle=0,this.rotateSpeed=.2,this.matchAngleThreshholdDegrees=1}set angle(e){null==this.imageElement?this._angle=e:(this.setAngleToTarget(e),this.startRotateInterval()),this.angleChange.emit(this._angle)}get angle(){return this._angle}ngAfterViewInit(){}ngOnInit(){}setAngleToTarget(e){let n=this._angle-e;this._angle=e,Math.abs(n)>=355&&(n>0?this.circleIncrement+=1:this.circleIncrement-=1),this.adjustedAngle=e+360*this.circleIncrement}startRotateInterval(){null==this.rotateInterval&&(this.rotateInterval=setInterval(()=>{this.rotateTowardsAngle()},40))}stopRotateInterval(){clearInterval(this.rotateInterval),this.rotateInterval=void 0}rotateTowardsAngle(){let e=this.lerp(this.currentAngle,this.adjustedAngle,this.rotateSpeed),n=Math.abs(this.adjustedAngle-this.currentAngle);this.animateAngle=e,n>this.matchAngleThreshholdDegrees?this.updateAngle(e):this.stopRotateInterval()}updateAngle(e){this.currentAngle=e}lerp(e,n,a){return e*(1-a)+n*a}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.Qsj))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-compass"]],viewQuery:function(e,n){if(1&e&&t.Gf(rt,7),2&e){let a;t.iGM(a=t.CRH())&&(n.imageElement=a.first)}},inputs:{angle:"angle"},outputs:{angleChange:"angleChange"},decls:5,vars:11,consts:[[1,"w-full","h-full","surface-ground","flex","align-items-center","justify-content-center","overflow-hidden"],["imageContainer",""],[1,"z-5",3,"diameter","handleDiameter","angle","displayCircle","displayHandle","displayAngle","angleChange"],["id","compass-image","src","assets/images/compass-simple-inverted.svg","alt","Compass image","ondragstart","return false;","onmousedown","return false;",1,"absolute",3,"ngStyle","width","height"],["compassImage",""]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0,1)(2,"circular-slider-wrapper",2),t.NdJ("angleChange",function(s){return n.angle=s}),t.qZA(),t._UZ(3,"p-image",3,4),t.qZA()),2&e){const a=t.MAs(1);t.xp6(2),t.Q6J("diameter",n.sliderDiameter)("handleDiameter",n.handleDiameter)("angle",n.angle)("displayCircle",!1)("displayHandle",!1)("displayAngle",!1),t.xp6(1),t.Q6J("ngStyle",t.VKq(9,ct,"rotate("+n.animateAngle+"deg)"))("width",.9*a.offsetWidth+"px")("height",.9*a.offsetHeight+"px")}},dependencies:[h.PC,F.E,lt]}),i})();var b=c(9592);const ht=["sliderHandle"],pt=["sliderHandleStart"],ut=["sliderHandleEnd"],gt=function(i,o){return{left:i,width:o}};function mt(i,o){if(1&i&&t._UZ(0,"span",4),2&i){const e=t.oxw();t.Q6J("ngStyle",t.WLB(1,gt,null!=e.offset?e.offset+"%":e.handleValues[0]+"%",e.diff?e.diff+"%":e.handleValues[1]-e.handleValues[0]+"%"))}}const ft=function(i,o){return{bottom:i,height:o}};function vt(i,o){if(1&i&&t._UZ(0,"span",4),2&i){const e=t.oxw();t.Q6J("ngStyle",t.WLB(1,ft,null!=e.offset?e.offset+"%":e.handleValues[0]+"%",e.diff?e.diff+"%":e.handleValues[1]-e.handleValues[0]+"%"))}}const _t=function(i){return{height:i}};function yt(i,o){if(1&i&&t._UZ(0,"span",4),2&i){const e=t.oxw();t.Q6J("ngStyle",t.VKq(1,_t,e.handleValue+"%"))}}const Ct=function(i){return{width:i}};function xt(i,o){if(1&i&&t._UZ(0,"span",4),2&i){const e=t.oxw();t.Q6J("ngStyle",t.VKq(1,Ct,e.handleValue+"%"))}}const k=function(i,o){return{left:i,bottom:o}};function bt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"span",5,6),t.NdJ("keydown",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onHandleKeydown(a))})("mousedown",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onMouseDown(a))})("touchstart",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onTouchStart(a))})("touchmove",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onTouchMove(a))})("touchend",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onTouchEnd(a))}),t.qZA()}if(2&i){const e=t.oxw();t.Udp("transition",e.dragging?"none":null),t.Q6J("ngStyle",t.WLB(8,k,"horizontal"==e.orientation?e.handleValue+"%":null,"vertical"==e.orientation?e.handleValue+"%":null)),t.uIk("tabindex",e.disabled?null:e.tabindex)("aria-valuemin",e.min)("aria-valuenow",e.value)("aria-valuemax",e.max)("aria-labelledby",e.ariaLabelledBy)}}const q=function(i){return{"p-slider-handle-active":i}};function Mt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"span",7,8),t.NdJ("keydown",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onHandleKeydown(a,0))})("mousedown",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onMouseDown(a,0))})("touchstart",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onTouchStart(a,0))})("touchmove",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onTouchMove(a,0))})("touchend",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onTouchEnd(a))}),t.qZA()}if(2&i){const e=t.oxw();t.Udp("transition",e.dragging?"none":null),t.Q6J("ngStyle",t.WLB(9,k,e.rangeStartLeft,e.rangeStartBottom))("ngClass",t.VKq(12,q,0==e.handleIndex)),t.uIk("tabindex",e.disabled?null:e.tabindex)("aria-valuemin",e.min)("aria-valuenow",e.value?e.value[0]:null)("aria-valuemax",e.max)("aria-labelledby",e.ariaLabelledBy)}}function St(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"span",7,9),t.NdJ("keydown",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onHandleKeydown(a,1))})("mousedown",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onMouseDown(a,1))})("touchstart",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onTouchStart(a,1))})("touchmove",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onTouchMove(a,1))})("touchend",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onTouchEnd(a))}),t.qZA()}if(2&i){const e=t.oxw();t.Udp("transition",e.dragging?"none":null),t.Q6J("ngStyle",t.WLB(9,k,e.rangeEndLeft,e.rangeEndBottom))("ngClass",t.VKq(12,q,1==e.handleIndex)),t.uIk("tabindex",e.disabled?null:e.tabindex)("aria-valuemin",e.min)("aria-valuenow",e.value?e.value[1]:null)("aria-valuemax",e.max)("aria-labelledby",e.ariaLabelledBy)}}const wt=function(i,o,e,n){return{"p-slider p-component":!0,"p-disabled":i,"p-slider-horizontal":o,"p-slider-vertical":e,"p-slider-animate":n}},Tt={provide:g.JU,useExisting:(0,t.Gpc)(()=>W),multi:!0};let W=(()=>{class i{constructor(e,n,a,s){this.el=e,this.renderer=n,this.ngZone=a,this.cd=s,this.min=0,this.max=100,this.orientation="horizontal",this.tabindex=0,this.onChange=new t.vpe,this.onSlideEnd=new t.vpe,this.handleValues=[],this.onModelChange=()=>{},this.onModelTouched=()=>{},this.handleIndex=0}onMouseDown(e,n){this.disabled||(this.dragging=!0,this.updateDomData(),this.sliderHandleClick=!0,this.handleIndex=this.range&&this.handleValues&&this.handleValues[0]===this.max?0:n,this.bindDragListeners(),e.target.focus(),e.preventDefault(),this.animate&&b.p.removeClass(this.el.nativeElement.children[0],"p-slider-animate"))}onTouchStart(e,n){if(!this.disabled){var a=e.changedTouches[0];this.startHandleValue=this.range?this.handleValues[n]:this.handleValue,this.dragging=!0,this.handleIndex=this.range&&this.handleValues&&this.handleValues[0]===this.max?0:n,"horizontal"===this.orientation?(this.startx=parseInt(a.clientX,10),this.barWidth=this.el.nativeElement.children[0].offsetWidth):(this.starty=parseInt(a.clientY,10),this.barHeight=this.el.nativeElement.children[0].offsetHeight),this.animate&&b.p.removeClass(this.el.nativeElement.children[0],"p-slider-animate"),e.preventDefault()}}onTouchMove(e,n){if(!this.disabled){var s,a=e.changedTouches[0];s="horizontal"===this.orientation?Math.floor(100*(parseInt(a.clientX,10)-this.startx)/this.barWidth)+this.startHandleValue:Math.floor(100*(this.starty-parseInt(a.clientY,10))/this.barHeight)+this.startHandleValue,this.setValueFromHandle(e,s),e.preventDefault()}}onTouchEnd(e,n){this.disabled||(this.dragging=!1,this.onSlideEnd.emit(this.range?{originalEvent:e,values:this.values}:{originalEvent:e,value:this.value}),this.animate&&b.p.addClass(this.el.nativeElement.children[0],"p-slider-animate"),e.preventDefault())}onBarClick(e){this.disabled||(this.sliderHandleClick||(this.updateDomData(),this.handleChange(e)),this.sliderHandleClick=!1)}onHandleKeydown(e,n){this.disabled||(38==e.which||39==e.which?this.spin(e,1,n):(37==e.which||40==e.which)&&this.spin(e,-1,n))}spin(e,n,a){let s=(this.step||1)*n;this.range?(this.handleIndex=a,this.updateValue(this.values[this.handleIndex]+s),this.updateHandleValue()):(this.updateValue(this.value+s),this.updateHandleValue()),e.preventDefault()}handleChange(e){let n=this.calculateHandleValue(e);this.setValueFromHandle(e,n)}bindDragListeners(){this.ngZone.runOutsideAngular(()=>{const e=this.el?this.el.nativeElement.ownerDocument:"document";this.dragListener||(this.dragListener=this.renderer.listen(e,"mousemove",n=>{this.dragging&&this.ngZone.run(()=>{this.handleChange(n)})})),this.mouseupListener||(this.mouseupListener=this.renderer.listen(e,"mouseup",n=>{this.dragging&&(this.dragging=!1,this.ngZone.run(()=>{this.onSlideEnd.emit(this.range?{originalEvent:n,values:this.values}:{originalEvent:n,value:this.value}),this.animate&&b.p.addClass(this.el.nativeElement.children[0],"p-slider-animate")}))}))})}unbindDragListeners(){this.dragListener&&this.dragListener(),this.mouseupListener&&this.mouseupListener()}setValueFromHandle(e,n){this.sliderHandleClick=!1;let a=this.getValueFromHandle(n);this.range?this.step?this.handleStepChange(a,this.values[this.handleIndex]):(this.handleValues[this.handleIndex]=n,this.updateValue(a,e)):this.step?this.handleStepChange(a,this.value):(this.handleValue=n,this.updateValue(a,e)),this.cd.markForCheck()}handleStepChange(e,n){let a=e-n,s=n;a<0?s=n+Math.ceil(e/this.step-n/this.step)*this.step:a>0&&(s=n+Math.floor(e/this.step-n/this.step)*this.step),this.updateValue(s),this.updateHandleValue()}writeValue(e){this.range?this.values=e||[0,0]:this.value=e||0,this.updateHandleValue(),this.updateDiffAndOffset(),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}get rangeStartLeft(){return this.isVertical()?null:this.handleValues[0]>100?"100%":this.handleValues[0]+"%"}get rangeStartBottom(){return this.isVertical()?this.handleValues[0]+"%":"auto"}get rangeEndLeft(){return this.isVertical()?null:this.handleValues[1]+"%"}get rangeEndBottom(){return this.isVertical()?this.handleValues[1]+"%":"auto"}isVertical(){return"vertical"===this.orientation}updateDomData(){let e=this.el.nativeElement.children[0].getBoundingClientRect();this.initX=e.left+b.p.getWindowScrollLeft(),this.initY=e.top+b.p.getWindowScrollTop(),this.barWidth=this.el.nativeElement.children[0].offsetWidth,this.barHeight=this.el.nativeElement.children[0].offsetHeight}calculateHandleValue(e){return"horizontal"===this.orientation?100*(e.pageX-this.initX)/this.barWidth:100*(this.initY+this.barHeight-e.pageY)/this.barHeight}updateHandleValue(){this.range?(this.handleValues[0]=100*(this.values[0]<this.min?0:this.values[0]-this.min)/(this.max-this.min),this.handleValues[1]=100*(this.values[1]>this.max?100:this.values[1]-this.min)/(this.max-this.min)):this.handleValue=this.value<this.min?0:this.value>this.max?100:100*(this.value-this.min)/(this.max-this.min),this.step&&this.updateDiffAndOffset()}updateDiffAndOffset(){this.diff=this.getDiff(),this.offset=this.getOffset()}getDiff(){return Math.abs(this.handleValues[0]-this.handleValues[1])}getOffset(){return Math.min(this.handleValues[0],this.handleValues[1])}updateValue(e,n){if(this.range){let a=e;0==this.handleIndex?(a<this.min?(a=this.min,this.handleValues[0]=0):a>this.values[1]&&a>this.max&&(a=this.max,this.handleValues[0]=100),this.sliderHandleStart.nativeElement.focus()):(a>this.max?(a=this.max,this.handleValues[1]=100,this.offset=this.handleValues[1]):a<this.min?(a=this.min,this.handleValues[1]=0):a<this.values[0]&&(this.offset=this.handleValues[1]),this.sliderHandleEnd.nativeElement.focus()),this.step?this.updateHandleValue():this.updateDiffAndOffset(),this.values[this.handleIndex]=this.getNormalizedValue(a),this.onModelChange([this.minVal,this.maxVal]),this.onChange.emit({event:n,values:this.values})}else e<this.min?(e=this.min,this.handleValue=0):e>this.max&&(e=this.max,this.handleValue=100),this.value=this.getNormalizedValue(e),this.onModelChange(this.value),this.onChange.emit({event:n,value:this.value}),this.sliderHandle.nativeElement.focus()}getValueFromHandle(e){return e/100*(this.max-this.min)+this.min}getDecimalsCount(e){return e&&Math.floor(e)!==e&&e.toString().split(".")[1].length||0}getNormalizedValue(e){let n=this.getDecimalsCount(this.step);return n>0?+parseFloat(e.toString()).toFixed(n):Math.floor(e)}ngOnDestroy(){this.unbindDragListeners()}get minVal(){return Math.min(this.values[1],this.values[0])}get maxVal(){return Math.max(this.values[1],this.values[0])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq),t.Y36(t.Qsj),t.Y36(t.R0b),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["p-slider"]],viewQuery:function(e,n){if(1&e&&(t.Gf(ht,5),t.Gf(pt,5),t.Gf(ut,5)),2&e){let a;t.iGM(a=t.CRH())&&(n.sliderHandle=a.first),t.iGM(a=t.CRH())&&(n.sliderHandleStart=a.first),t.iGM(a=t.CRH())&&(n.sliderHandleEnd=a.first)}},hostAttrs:[1,"p-element"],inputs:{animate:"animate",disabled:"disabled",min:"min",max:"max",orientation:"orientation",step:"step",range:"range",style:"style",styleClass:"styleClass",ariaLabelledBy:"ariaLabelledBy",tabindex:"tabindex"},outputs:{onChange:"onChange",onSlideEnd:"onSlideEnd"},features:[t._Bn([Tt])],decls:8,vars:16,consts:[[3,"ngStyle","ngClass","click"],["class","p-slider-range",3,"ngStyle",4,"ngIf"],["class","p-slider-handle",3,"transition","ngStyle","keydown","mousedown","touchstart","touchmove","touchend",4,"ngIf"],["class","p-slider-handle",3,"transition","ngStyle","ngClass","keydown","mousedown","touchstart","touchmove","touchend",4,"ngIf"],[1,"p-slider-range",3,"ngStyle"],[1,"p-slider-handle",3,"ngStyle","keydown","mousedown","touchstart","touchmove","touchend"],["sliderHandle",""],[1,"p-slider-handle",3,"ngStyle","ngClass","keydown","mousedown","touchstart","touchmove","touchend"],["sliderHandleStart",""],["sliderHandleEnd",""]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(s){return n.onBarClick(s)}),t.YNc(1,mt,1,4,"span",1),t.YNc(2,vt,1,4,"span",1),t.YNc(3,yt,1,3,"span",1),t.YNc(4,xt,1,3,"span",1),t.YNc(5,bt,2,11,"span",2),t.YNc(6,Mt,2,14,"span",3),t.YNc(7,St,2,14,"span",3),t.qZA()),2&e&&(t.Tol(n.styleClass),t.Q6J("ngStyle",n.style)("ngClass",t.l5B(11,wt,n.disabled,"horizontal"==n.orientation,"vertical"==n.orientation,n.animate)),t.xp6(1),t.Q6J("ngIf",n.range&&"horizontal"==n.orientation),t.xp6(1),t.Q6J("ngIf",n.range&&"vertical"==n.orientation),t.xp6(1),t.Q6J("ngIf",!n.range&&"vertical"==n.orientation),t.xp6(1),t.Q6J("ngIf",!n.range&&"horizontal"==n.orientation),t.xp6(1),t.Q6J("ngIf",!n.range),t.xp6(1),t.Q6J("ngIf",n.range),t.xp6(1),t.Q6J("ngIf",n.range))},dependencies:[h.mk,h.O5,h.PC],styles:[".p-slider{position:relative}.p-slider .p-slider-handle{position:absolute;cursor:grab;touch-action:none;display:block}.p-slider-range{position:absolute;display:block}.p-slider-horizontal .p-slider-range{top:0;left:0;height:100%}.p-slider-horizontal .p-slider-handle{top:50%}.p-slider-vertical{height:100px}.p-slider-vertical .p-slider-handle{left:50%}.p-slider-vertical .p-slider-range{bottom:0;left:0;width:100%}\n"],encapsulation:2,changeDetection:0}),i})(),Lt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.ez]}),i})();const Dt=[{path:"",component:(()=>{class i{constructor(e,n){this.router=e,this.normalServices=n,this.knobValue=69,this.pingSuccess=!1,this.pingResponse="",this.showBuyMeACoffee=!1,this.compassAngle=45,this.randomProduct="sausage roll",this.products=["pasty","pie","yum-yum","vegan sausage roll","sausage roll","steak bake","pizza slice","chicken bake","cheese & onion bake","sausage & bacon bap"]}ngOnInit(){this.changeProductAfterSeconds(8),this.showBuyMeACoffee&&document.documentElement.style.setProperty("--bmac-visibility","visible")}getRandomProduct(){let e=this.randomIntExcept(0,this.products.length-1,this.products.indexOf(this.randomProduct));return this.products[e]}changeProductAfterSeconds(e){var n=this;return N(function*(){yield new Promise(a=>setTimeout(a,1e3*e)),n.randomProduct=n.getRandomProduct(),n.compassAngle=n.randomInt(0,360)%360,n.changeProductAfterSeconds(e)})()}pingServer(){this.normalServices.ping().subscribe({next:e=>{this.pingSuccess=!0,this.pingResponse=e.message},error:e=>{console.log("Ping failure"),this.pingSuccess=!1}})}changeKnobValueAfterSeconds(e){var n=this;return N(function*(){yield new Promise(a=>setTimeout(a,1e3*e)),n.knobValue=(n.knobValue+1)%100,n.changeKnobValueAfterSeconds(.3)})()}randomInt(e,n){return Math.floor(Math.random()*(n-e+1)+e)}randomIntExcept(e,n,a){let s=a;for(;s===a;)s=Math.floor(Math.random()*(n-e+1)+e);return s}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M.F0),t.Y36(ee))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-home"]],decls:24,vars:5,consts:[[1,"p-2"],["header","Fuck Greggs",1,"p-2"],[1,"pi","pi-spin","pi-user",2,"font-size","1rem","color","red"],["header","Map",1,"p-2"],["header","Compass",1,"p-2"],[1,"w-20rem","h-20rem"],[3,"angle","angleChange"],[1,"w-20rem",3,"ngModel","min","max","ngModelChange"],["header","Nav",1,"p-2"],[1,"flex","gap-2"],["routerLink","../peaches"],["label","Peaches"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"p-card",1)(2,"p"),t._uU(3),t._UZ(4,"br"),t._uU(5,"from anywhere that isn't Greggs. "),t.qZA(),t.TgZ(6,"p"),t._uU(7,"Plus the "),t._UZ(8,"i",2),t._uU(9," son "),t._UZ(10,"i",2),t._uU(11," of the founder may or may not be a convicted "),t.TgZ(12,"b"),t._uU(13,"[REDACTED]"),t.qZA()()(),t.TgZ(14,"p-card",3),t._UZ(15,"app-normal-map"),t.qZA(),t.TgZ(16,"p-card",4)(17,"div",5)(18,"app-compass",6),t.NdJ("angleChange",function(s){return n.compassAngle=s}),t.qZA(),t.TgZ(19,"p-slider",7),t.NdJ("ngModelChange",function(s){return n.compassAngle=s}),t.qZA()()(),t.TgZ(20,"p-card",8)(21,"div",9)(22,"a",10),t._UZ(23,"p-button",11),t.qZA()()()()),2&e&&(t.xp6(3),t.hij(" For when you want a ",n.randomProduct," "),t.xp6(15),t.Q6J("angle",n.compassAngle),t.xp6(1),t.Q6J("ngModel",n.compassAngle)("min",0)("max",360))},dependencies:[M.yS,g.JJ,g.On,P.Z,v.zx,Ae,dt,W]}),i})()}];let It=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[M.Bz.forChild(Dt),M.Bz]}),i})();var At=c(4949),kt=c(7261),Rt=c(875);let Zt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.ez,It,h.ez,g.u5,P.d,v.hJ,kt.dJ,M.Bz,At.S,Lt,Rt.X]}),i})()}}]);